<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>More/Top Demos</title>
<style>
    body, html {
        height: 100%;
        margin: 0;
        font-size: 22.8px;
        line-height: 1.1;
        font-family: calibri, Arial, sans-serif;
    }
    .content {
        min-height: 100px;
        padding: 30px;
    }

    textarea {
    margin: 0;
    width: 100%;
    padding: 10px;
    box-sizing: border-box;
}

        /* Base button class for shared styles */
        .floating-btn {
        display: none;
        position: fixed;
        right: 34px;
        bottom: 53px;
        width: 63px;
        height: 63px;
        line-height: 50px;
        text-align: center;
        padding: 0;
        font-size: 19px;
        color: white;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        opacity: 0.85;
        transition: opacity 0.3s ease-out;
    }

    /* Specific button colors/variations */
    #moreBtn {
        background-color: rgb(17, 89, 167);
    }

    #topBtn {
        background-color: rgb(60, 60, 60);
    }

    /* Fade animation class */
    .fade-out {
        opacity: 0;
        pointer-events: none;
    }

    #regenerateBtn {
        display: none;
        position: fixed;
        left: 20px;
        top: 50px;
        padding: 10px 20px;
        font-size: 16px;
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    #toggleVersionBtn {
        position: fixed;
        left: 20px;
        top: 90px;
        padding: 10px 20px;
        font-size: 16px;
        background-color: #6c757d;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .version-controls {
        position: fixed;
        left: 20px;
        top: 95px;
        display: flex;
        flex-direction: column;
        gap: 0px;
    }

    .version-btn {
        padding: 10px 20px;
        font-size: 16px;
        border: 1px solid #6c757d;
        background-color: white;
        color: #004bbc;
        cursor: pointer;
        transition: all 0.2s ease;
        border-radius: 5px;
        text-align: left;
        min-width: 180px;
    }

    .version-btn.active {
        background-color: #007bff;
        border-color: #007bff;
        color: white;
        font-weight: bold;
    }

    #heightControl {
        position: fixed;
        left: 20px;
        top: 20px;
        z-index: 1000;
    }
</style>
</head>
<body>

    <div class="content" id="content">
        <h1 style="text-align: center;">More/Top Demos</h1>
        <h2 style="text-align: center;">Make the window smaller if needed to show More button.</h2>
        
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco.</p>
        
        <textarea style="height: 60px;"></textarea>
        
        <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
        
        <textarea style="height: 60px;"></textarea>
        
        <p>Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
        
        <textarea style="height: 250px;"></textarea>

        <div style="display: flex; justify-content: flex-end; align-items: center; gap: 9px; margin-top: 20px;">
            <span>Select <strong>Submit</strong> when you are finished.</span>
            <button style="background-color: #2478cc; font-size: 22.8px; color: white; border: none; padding: 11px 30px; border-radius: 4px; cursor: pointer;">Submit</button>
        </div>
    </div>

<input style="width: 210px" type="number" id="heightControl" value="" placeholder="Set content area height in pixels" title="Set content height in pixels">

<button id="moreBtn" class="floating-btn">
    <div style="position: relative; height: 100%;">
        <span>More</span>
        <svg 
            xmlns="http://www.w3.org/2000/svg" 
            viewBox="0 0 24 24" 
            fill="currentcolor" 
            style="
                position: absolute;
                width: 27px;
                height: 27px;
                left: 50%;
                transform: translateX(-50%) rotate(180deg);
                bottom: 5px;
            "
            role="presentation"
        >
            <path d="M21.5 17.5l-9.5-9.5-9.5 9.5-2.5-2.5 12-12 12 12-2.5 2.5z"></path>
        </svg>
    </div>
</button>


<button id="topBtn" class="floating-btn">
    <div style="position: relative; height: 100%;">
        <svg 
            xmlns="http://www.w3.org/2000/svg" 
            viewBox="0 0 24 24" 
            fill="currentcolor" 
            style="
                position: absolute;
                width: 24px;
                height: 24px;
                left: 50%;
                transform: translateX(-50%);
                top: 8px;
            "
            role="presentation"
        >
            <path d="M21.5 17.5l-9.5-9.5-9.5 9.5-2.5-2.5 12-12 12 12-2.5 2.5z"></path>
        </svg>
        <span style="width: 100%; position: relative; top: 14px;">Top</span>
    </div>
</button>


<button id="regenerateBtn">Reset</button>

<div class="version-controls">
    <button id="version1Btn" class="version-btn active">Current More/Top</button>
    <button id="version2Btn" class="version-btn">Fade-out</button>
    <button id="version3Btn" class="version-btn">More Only</button>
</div>

<script>
    const version1Btn = document.getElementById('version1Btn');
    const version2Btn = document.getElementById('version2Btn');
    const version3Btn = document.getElementById('version3Btn');

    document.addEventListener('DOMContentLoaded', function() {
        const content = document.getElementById('content');
        const moreBtn = document.getElementById('moreBtn');
        const regenerateBtn = document.getElementById('regenerateBtn');
        const heightControl = document.getElementById('heightControl');
        const toggleVersionBtn = document.getElementById('toggleVersionBtn');
        const topBtn = document.getElementById('topBtn');

        let lastScrollTop = window.scrollY;
        let currentVersion = 1;
        let moreButtonHiddenByScroll = false;
        let isTopButtonActive = false;
        let completedTopAction = false;
        let version2ButtonUsed = false;


        const buttonBehaviors = {
            version1: {
                updateVisibility: function() {
                    let actualHeight = content.scrollHeight - parseFloat(window.getComputedStyle(content).paddingTop);
                    let viewportHeight = window.innerHeight;
                    let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    
                    // Always show regenerate button
                    regenerateBtn.style.display = 'block';
                    
                    // Hide More and Top buttons by default
                    moreBtn.style.display = 'none';
                    topBtn.style.display = 'none';

                    if (scrollTop === 0) {
                        // At the top of the page
                        if (isTopButtonActive) {
                            // If we were showing Top button, hide it and prevent it from showing again
                            isTopButtonActive = false;
                            completedTopAction = true;
                        } else if (!completedTopAction) {
                            // Only show More if we haven't completed a top action
                            if (actualHeight > viewportHeight) {
                                moreBtn.style.display = 'block';
                            }
                        }
                    } else if (!completedTopAction) {
                        // Only handle scroll positions if we haven't completed a top action
                        if (window.innerHeight + scrollTop >= document.documentElement.scrollHeight - 20) {
                            // At the bottom of the page
                            isTopButtonActive = true;
                            topBtn.style.display = 'block';
                        } else if (isTopButtonActive) {
                            // Show Top button if it's active
                            topBtn.style.display = 'block';
                        } else {
                            // Show More button if no other conditions are met
                            moreBtn.style.display = 'block';
                        }
                    }
                },
                
                scrollBehavior: function() {
                    window.scrollTo({
                        left: 0,
                        top: document.body.scrollHeight,
                        behavior: 'smooth'
                    });
                },

                handleScroll: function() {
                    this.updateVisibility();
                }
            },
            

            
        version2: {
            updateVisibility: function() {
                // Always show regenerate button
                regenerateBtn.style.display = 'block';
                
                // Hide top button
                topBtn.style.display = 'none';
                
                // Only show More button if it hasn't been used yet
                if (!version2ButtonUsed) {
                    moreBtn.style.display = 'block';
                    moreBtn.classList.remove('fade-out');
                } else {
                    moreBtn.style.display = 'none';
                }
            },
            
            scrollBehavior: function() {
                const currentScroll = window.pageYOffset;
                const targetScroll = currentScroll + 150;
                
                // Smooth scroll with easing
                const startTime = performance.now();
                const duration = 800; // milliseconds

                function easeOutCubic(t) {
                    return 1 - Math.pow(1 - t, 3);
                }

                function scrollAnimation(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    const eased = easeOutCubic(progress);
                    const currentPosition = currentScroll + (targetScroll - currentScroll) * eased;
                    
                    window.scrollTo(0, currentPosition);
                    
                    if (progress < 1) {
                        requestAnimationFrame(scrollAnimation);
                    }
                }

                requestAnimationFrame(scrollAnimation);
                
                // Mark button as used after click
                version2ButtonUsed = true;
                moreBtn.classList.add('fade-out');
            },

            handleScroll: function() {
                const currentScrollY = window.scrollY;  // Get current scroll position
                
                // If we scrolled down (current Y is greater than last Y)
                if (currentScrollY > lastScrollTop) {
                    moreBtn.classList.add('fade-out');
                    version2ButtonUsed = true;
                }
                
                // Store current position for next comparison
                lastScrollTop = currentScrollY;
            }
        },
  



            version3: {
            updateVisibility: function() {
                // Always show regenerate button
                regenerateBtn.style.display = 'block';
                
                // Hide top button
                topBtn.style.display = 'none';
                
                let actualHeight = content.scrollHeight - parseFloat(window.getComputedStyle(content).paddingTop);
                let viewportHeight = window.innerHeight;
                let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                // Show More button by default
                moreBtn.style.display = 'block';
                moreBtn.classList.remove('fade-out');

                // Hide More button only when we reach the bottom
                if (window.innerHeight + scrollTop >= document.documentElement.scrollHeight - 20) {
                    moreBtn.classList.add('fade-out');
                }
            },
            
            scrollBehavior: function() {
                window.scrollTo({
                    left: 0,
                    top: document.body.scrollHeight,
                    behavior: 'smooth'
                });
            },

            handleScroll: function() {
                let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                // Only handle visibility when reaching bottom
                if (window.innerHeight + scrollTop >= document.documentElement.scrollHeight - 20) {
                    moreBtn.classList.add('fade-out');
                }
            }
        }
    };

        //  click handler for top button
        topBtn.addEventListener('click', function() {
            if (currentVersion === 1) {
                window.scrollTo({
                    left: 0,
                    top: 0,
                    behavior: 'smooth'
                });
            }
        });

    //  switchVersion function
    function switchToVersion(versionNumber) {
        currentVersion = versionNumber;
        
        //  button states
        version1Btn.classList.toggle('active', versionNumber === 1);
        version2Btn.classList.toggle('active', versionNumber === 2);
        version3Btn.classList.toggle('active', versionNumber === 3);
        
        // Reset all states
        moreButtonHiddenByScroll = false;
        isTopButtonActive = false;
        completedTopAction = false;
        version2ButtonUsed = false;
        lastScrollTop = window.scrollY;
        
        // Remove fade-out class when switching versions
        moreBtn.classList.remove('fade-out');
        
        updateButtonVisibility();
    }




    function updateButtonVisibility() {
        const behavior = currentVersion === 1 ? buttonBehaviors.version1 : 
                        currentVersion === 2 ? buttonBehaviors.version2 :
                        buttonBehaviors.version3;
        behavior.updateVisibility();
    }

        // Event Listeners
        heightControl.addEventListener('input', function() {
            content.style.height = this.value + 'px' || 'auto';
            moreButtonHiddenByScroll = false;
            updateButtonVisibility();
        });

        window.addEventListener('resize', updateButtonVisibility);

        window.addEventListener('scroll', function() {
        const behavior = currentVersion === 1 ? buttonBehaviors.version1 : 
                        currentVersion === 2 ? buttonBehaviors.version2 :
                        buttonBehaviors.version3;
        behavior.handleScroll();
    });

        regenerateBtn.addEventListener('click', function() {
            moreButtonHiddenByScroll = false;
            isTopButtonActive = false;
            completedTopAction = false;
            version2ButtonUsed = false; 
            lastScrollTop = window.scrollY;
            updateButtonVisibility();
        });

        moreBtn.addEventListener('click', function() {
        const behavior = currentVersion === 1 ? buttonBehaviors.version1 : 
                        currentVersion === 2 ? buttonBehaviors.version2 :
                        buttonBehaviors.version3;
        behavior.scrollBehavior();
    });

        version1Btn.addEventListener('click', () => switchToVersion(1));
        version2Btn.addEventListener('click', () => switchToVersion(2));
        version3Btn.addEventListener('click', () => switchToVersion(3));


        // Initial setup
        updateButtonVisibility();
    });
</script>

</body>
</html>